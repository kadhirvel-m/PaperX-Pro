<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deep Dive: DBMS Architecture & NoSQL</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Fira+Code:wght@400;600&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    colors: {
                        brand: {
                            500: '#3b82f6', // Blue
                            600: '#2563eb',
                        },
                        accent: {
                            500: '#f59e0b', // Amber for NoSQL
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Smooth Theme Transition */
        body {
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Background Grid Pattern */
        .grid-bg {
            background-image: linear-gradient(to right, rgba(128, 128, 128, 0.1) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(128, 128, 128, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* Glassmorphism that adapts to Light/Dark */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            /* Dark mode default */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Specific overrides for Light Mode in CSS to ensure reliability */
        html:not(.dark) body {
            background-color: #f8fafc;
            /* Slate-50 */
            color: #0f172a;
            /* Slate-900 */
        }

        html:not(.dark) .glass-panel {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #e2e8f0;
            /* Slate-200 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }

        html:not(.dark) .grid-bg {
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
        }

        .code-block {
            font-family: 'Fira Code', monospace;
            line-height: 1.5;
        }

        /* Packet Animation */
        .packet {
            width: 12px;
            height: 12px;
            background-color: #f43f5e;
            border-radius: 50%;
            position: absolute;
            z-index: 50;
            box-shadow: 0 0 10px #f43f5e;
            display: none;
            pointer-events: none;
        }

        /* Selection styling */
        .model-btn.active {
            background-color: rgba(59, 130, 246, 0.1);
            /* Brand color tint */
            border-color: #3b82f6;
        }
    </style>
</head>

<body class="bg-slate-950 text-slate-200 min-h-screen flex flex-col selection:bg-brand-500 selection:text-white">

    <nav
        class="w-full border-b border-slate-800 dark:border-slate-800 border-slate-200 bg-white/80 dark:bg-slate-950/80 backdrop-blur-md sticky top-0 z-50 transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-brand-600 rounded-lg flex items-center justify-center">
                    <i data-lucide="database" class="text-white w-5 h-5"></i>
                </div>
                <span class="font-bold text-lg tracking-tight text-slate-900 dark:text-white">DataModel<span
                        class="text-brand-500">Sim</span></span>
            </div>
            <button onclick="toggleTheme()"
                class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors border border-slate-300 dark:border-slate-700">
                <i data-lucide="sun" class="w-5 h-5 hidden dark:block text-yellow-400"></i>
                <i data-lucide="moon" class="w-5 h-5 block dark:hidden text-slate-600"></i>
            </button>
        </div>
    </nav>

    <main class="flex-1 max-w-7xl mx-auto w-full p-4 md:p-6 lg:p-8 flex flex-col gap-12">

        <section class="text-center py-6">
            <h1 class="text-4xl md:text-6xl font-extrabold mb-4 tracking-tight text-slate-900 dark:text-white">
                How Computers <span
                    class="text-transparent bg-clip-text bg-gradient-to-r from-brand-500 to-purple-500">Remember
                    Relationships</span>
            </h1>
        </section>

        <section class="glass-panel rounded-2xl p-8 md:p-10 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-8 opacity-10 pointer-events-none">
                <i data-lucide="layout-template" class="w-32 h-32"></i>
            </div>

            <div class="relative z-10">
                <h2 class="text-2xl font-bold mb-4 text-slate-900 dark:text-white">What is a Data Model?</h2>

                <p class="text-lg text-slate-600 dark:text-slate-300 leading-relaxed max-w-3xl mb-10">
                    Think of a Data Model as the <strong>architectural plan</strong> for a building. Before you lay
                    bricks (store data), you need to decide if you're building a skyscraper, a sprawling ranch, or a
                    network of underground tunnels. It defines the logical structure of a database, including
                    relationships, constraints, and data types.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div
                        class="flex flex-col gap-3 p-4 rounded-xl bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800">
                        <div
                            class="w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 flex items-center justify-center">
                            <i data-lucide="layout" class="w-5 h-5"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-slate-900 dark:text-white">Structure</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">How data is stored (Tables, Trees,
                                Graphs, or Documents).</p>
                        </div>
                    </div>

                    <div
                        class="flex flex-col gap-3 p-4 rounded-xl bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800">
                        <div
                            class="w-10 h-10 rounded-lg bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 flex items-center justify-center">
                            <i data-lucide="link" class="w-5 h-5"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-slate-900 dark:text-white">Relationships</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">How data elements connect (1:1,
                                One-to-Many, Many-to-Many).</p>
                        </div>
                    </div>

                    <div
                        class="flex flex-col gap-3 p-4 rounded-xl bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800">
                        <div
                            class="w-10 h-10 rounded-lg bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 flex items-center justify-center">
                            <i data-lucide="shield-check" class="w-5 h-5"></i>
                        </div>
                        <div>
                            <h3 class="font-bold text-slate-900 dark:text-white">Constraints</h3>
                            <p class="text-sm text-slate-500 dark:text-slate-400">Rules to ensure data integrity (e.g.,
                                "Age cannot be negative").</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-12 gap-6 h-auto lg:h-[700px]">

            <div class="lg:col-span-3 flex flex-col gap-4">

                <div class="glass-panel p-5 rounded-xl flex flex-col gap-2">
                    <h3 class="text-xs font-bold uppercase text-slate-500 tracking-wider mb-2">Select Architecture</h3>

                    <button onclick="setMode('hierarchical')" id="btn-hierarchical"
                        class="model-btn text-left p-3 rounded-lg border border-transparent hover:bg-slate-100 dark:hover:bg-slate-800 transition-all group active">
                        <div class="flex items-center gap-3">
                            <i data-lucide="network" class="text-emerald-500"></i>
                            <div>
                                <div class="font-bold text-sm text-slate-900 dark:text-white">Hierarchical</div>
                                <div class="text-[10px] text-slate-500">The "Tree" Structure</div>
                            </div>
                        </div>
                    </button>

                    <button onclick="setMode('network')" id="btn-network"
                        class="model-btn text-left p-3 rounded-lg border border-transparent hover:bg-slate-100 dark:hover:bg-slate-800 transition-all group">
                        <div class="flex items-center gap-3">
                            <i data-lucide="share-2" class="text-orange-500"></i>
                            <div>
                                <div class="font-bold text-sm text-slate-900 dark:text-white">Network</div>
                                <div class="text-[10px] text-slate-500">The "Graph" Structure</div>
                            </div>
                        </div>
                    </button>

                    <button onclick="setMode('relational')" id="btn-relational"
                        class="model-btn text-left p-3 rounded-lg border border-transparent hover:bg-slate-100 dark:hover:bg-slate-800 transition-all group">
                        <div class="flex items-center gap-3">
                            <i data-lucide="table" class="text-brand-500"></i>
                            <div>
                                <div class="font-bold text-sm text-slate-900 dark:text-white">Relational (SQL)</div>
                                <div class="text-[10px] text-slate-500">The "Table" Structure</div>
                            </div>
                        </div>
                    </button>

                    <button onclick="setMode('nosql')" id="btn-nosql"
                        class="model-btn text-left p-3 rounded-lg border border-transparent hover:bg-slate-100 dark:hover:bg-slate-800 transition-all group">
                        <div class="flex items-center gap-3">
                            <i data-lucide="files" class="text-accent-500"></i>
                            <div>
                                <div class="font-bold text-sm text-slate-900 dark:text-white">NoSQL (Doc)</div>
                                <div class="text-[10px] text-slate-500">The "JSON" Structure</div>
                            </div>
                        </div>
                    </button>
                </div>

                <div class="glass-panel p-5 rounded-xl flex-1 flex flex-col gap-6">
                    <h3 class="text-xs font-bold uppercase text-slate-500 tracking-wider">Performance Metrics</h3>

                    <div>
                        <div class="flex justify-between text-sm mb-1 text-slate-700 dark:text-slate-200">
                            <span>Query Complexity</span>
                            <span id="metric-complexity-val" class="font-mono text-brand-500 font-bold">Low</span>
                        </div>
                        <div class="h-2 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden">
                            <div id="metric-complexity-bar"
                                class="h-full bg-brand-500 w-1/3 transition-all duration-1000 ease-out"></div>
                        </div>
                    </div>

                    <div>
                        <div class="flex justify-between text-sm mb-1 text-slate-700 dark:text-slate-200">
                            <span>Flexibility</span>
                            <span id="metric-flex-val" class="font-mono text-brand-500 font-bold">Rigid</span>
                        </div>
                        <div class="h-2 bg-slate-200 dark:bg-slate-800 rounded-full overflow-hidden">
                            <div id="metric-flex-bar"
                                class="h-full bg-purple-500 w-1/5 transition-all duration-1000 ease-out"></div>
                        </div>
                    </div>

                    <div class="mt-auto bg-slate-900 rounded-lg p-3 border border-slate-800 shadow-inner">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-[10px] uppercase text-slate-400 font-bold">Code / Syntax</span>
                            <div class="flex gap-1">
                                <div class="w-2 h-2 rounded-full bg-red-500"></div>
                                <div class="w-2 h-2 rounded-full bg-yellow-500"></div>
                                <div class="w-2 h-2 rounded-full bg-green-500"></div>
                            </div>
                        </div>
                        <pre id="code-preview"
                            class="code-block text-[10px] text-emerald-300 overflow-x-auto whitespace-pre-wrap">
// Hierarchical Pointers
Parent -> Child
                        </pre>
                    </div>

                </div>
            </div>

            <div
                class="lg:col-span-9 relative bg-slate-100 dark:bg-slate-900 rounded-xl overflow-hidden border border-slate-300 dark:border-slate-800 shadow-2xl group transition-colors duration-300">

                <div class="absolute inset-0 grid-bg opacity-30"></div>

                <div class="absolute top-4 left-4 z-20 pointer-events-none">
                    <span id="sim-title"
                        class="text-2xl font-bold text-slate-900 dark:text-white drop-shadow-sm">Hierarchical
                        Model</span>
                    <p id="sim-desc" class="text-sm text-slate-600 dark:text-slate-400 max-w-md mt-1">Data is stored
                        like a family tree.</p>
                </div>

                <div class="absolute top-4 right-4 z-20">
                    <button onclick="runQuery()" id="btn-query"
                        class="flex items-center gap-2 bg-brand-600 hover:bg-brand-500 text-white px-4 py-2 rounded-lg font-bold shadow-lg transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed">
                        <i data-lucide="play" class="w-4 h-4 fill-current"></i>
                        Simulate Query
                    </button>
                    <div id="query-status"
                        class="text-xs text-right mt-2 font-mono text-brand-600 dark:text-brand-400 opacity-0 transition-opacity">
                        Searching for "Project X"...</div>
                </div>

                <div id="canvas" class="w-full h-full relative overflow-hidden">
                    <svg id="connections" class="absolute inset-0 w-full h-full pointer-events-none z-0">
                    </svg>

                    <div id="packet" class="packet"></div>

                </div>

            </div>
        </section>

        <section class="max-w-6xl mx-auto w-full pb-24">

            <div class="border-b border-slate-200 dark:border-slate-800 flex gap-4 md:gap-8 mb-8 overflow-x-auto">
                <button
                    class="tab-btn pb-4 text-sm font-bold border-b-2 border-brand-500 text-slate-900 dark:text-white transition-colors"
                    onclick="showTab('tab-hierarchical')">Hierarchical</button>
                <button
                    class="tab-btn pb-4 text-sm font-bold border-b-2 border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 transition-colors"
                    onclick="showTab('tab-network')">Network</button>
                <button
                    class="tab-btn pb-4 text-sm font-bold border-b-2 border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 transition-colors"
                    onclick="showTab('tab-relational')">Relational (SQL)</button>
                <button
                    class="tab-btn pb-4 text-sm font-bold border-b-2 border-transparent text-slate-500 hover:text-slate-700 dark:hover:text-slate-300 transition-colors"
                    onclick="showTab('tab-nosql')">NoSQL (Doc)</button>
            </div>

            <div id="tab-hierarchical" class="tab-content grid md:grid-cols-2 gap-8 animate-fade-in">
                <div>
                    <h3 class="text-2xl font-bold mb-4 flex items-center gap-2 text-slate-900 dark:text-white">
                        <i data-lucide="network" class="text-emerald-500"></i> The Hierarchical Model
                    </h3>
                    <p class="text-slate-600 dark:text-slate-400 leading-relaxed mb-4">
                        Developed in the 1960s (IBM IMS) for the Apollo space program. It organizes data in a tree-like
                        structure where a single "Parent" record owns multiple "Child" records.
                    </p>
                    <div
                        class="bg-slate-100 dark:bg-slate-900 p-4 rounded-lg border border-slate-200 dark:border-slate-800 mb-4">
                        <h4 class="font-bold text-sm text-slate-900 dark:text-slate-300 mb-2">Detailed Real World
                            Example: Windows Registry</h4>
                        <p class="text-xs text-slate-500 dark:text-slate-400">
                            The Windows Registry stores configuration data. <br>
                            <code>HKEY_LOCAL_MACHINE -> SOFTWARE -> Microsoft -> Windows</code><br>
                            To get to the Windows settings, you MUST traverse the path. You cannot jump straight to the
                            leaf node without knowing the tree structure.
                        </p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 rounded bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 flex items-center justify-center flex-shrink-0">
                            <i data-lucide="check" class="w-3 h-3"></i>
                        </div>
                        <div>
                            <span class="font-bold text-sm text-slate-900 dark:text-white">Pros</span>
                            <p class="text-xs text-slate-500 dark:text-slate-400">Extremely fast data retrieval if you
                                know the exact path. Integrity is built-in (Child cannot exist without Parent).</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-network" class="tab-content hidden grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-2xl font-bold mb-4 flex items-center gap-2 text-slate-900 dark:text-white">
                        <i data-lucide="share-2" class="text-orange-500"></i> The Network Model
                    </h3>
                    <p class="text-slate-600 dark:text-slate-400 leading-relaxed mb-4">
                        Created to solve the redundancy of the Hierarchical model. A child (Member) can have multiple
                        parents (Owners). It uses complex physical pointers (Graph).
                    </p>
                    <div
                        class="bg-slate-100 dark:bg-slate-900 p-4 rounded-lg border border-slate-200 dark:border-slate-800 mb-4">
                        <h4 class="font-bold text-sm text-slate-900 dark:text-slate-300 mb-2">Detailed Real World
                            Example: DNS (Domain Name System)</h4>
                        <p class="text-xs text-slate-500 dark:text-slate-400">
                            The internet's phonebook. A single IP address can be pointed to by many Domain Names
                            (Parents). <br>
                            <code>google.com -> 8.8.8.8</code> <br>
                            <code>dns.google -> 8.8.8.8</code> <br>
                            Multiple paths lead to the same destination node.
                        </p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 rounded bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 flex items-center justify-center flex-shrink-0">
                            <i data-lucide="check" class="w-3 h-3"></i>
                        </div>
                        <div>
                            <span class="font-bold text-sm text-slate-900 dark:text-white">Pros</span>
                            <p class="text-xs text-slate-500 dark:text-slate-400">Handles Many-to-Many relationships
                                efficiently without data duplication.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-relational" class="tab-content hidden grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-2xl font-bold mb-4 flex items-center gap-2 text-slate-900 dark:text-white">
                        <i data-lucide="table" class="text-brand-500"></i> The Relational Model (SQL)
                    </h3>
                    <p class="text-slate-600 dark:text-slate-400 leading-relaxed mb-4">
                        Data is stored in <strong>Tables</strong> (Relations). They are mathematically independent.
                        Relationships are formed dynamically using Keys (IDs).
                    </p>
                    <div
                        class="bg-slate-100 dark:bg-slate-900 p-4 rounded-lg border border-slate-200 dark:border-slate-800 mb-4">
                        <h4 class="font-bold text-sm text-slate-900 dark:text-slate-300 mb-2">Detailed Real World
                            Example: Core Banking Systems</h4>
                        <p class="text-xs text-slate-500 dark:text-slate-400">
                            <strong>Table 1 (Customers):</strong> ID, Name, Address.<br>
                            <strong>Table 2 (Accounts):</strong> ID, Type, Balance.<br>
                            <strong>Table 3 (Transactions):</strong> ID, Amount, FromAccountID, ToAccountID.<br>
                            A transaction links two accounts logically. The money isn't "inside" the customer object;
                            it's a separate record referenced by ID. This ensures <strong class="text-brand-500">ACID
                                properties</strong> (reliability).
                        </p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 rounded bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 flex items-center justify-center flex-shrink-0">
                            <i data-lucide="check" class="w-3 h-3"></i>
                        </div>
                        <div>
                            <span class="font-bold text-sm text-slate-900 dark:text-white">Pros</span>
                            <p class="text-xs text-slate-500 dark:text-slate-400">Structural Independence. Powerful
                                Query Language (SQL). Great data integrity.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-nosql" class="tab-content hidden grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="text-2xl font-bold mb-4 flex items-center gap-2 text-slate-900 dark:text-white">
                        <i data-lucide="files" class="text-accent-500"></i> NoSQL (Document Model)
                    </h3>
                    <p class="text-slate-600 dark:text-slate-400 leading-relaxed mb-4">
                        Designed for Big Data and agility. Instead of splitting data into many tables, NoSQL stores all
                        related data in a single <strong>Document</strong> (usually JSON). It prioritizes speed and
                        scalability over strict structure.
                    </p>
                    <div
                        class="bg-slate-100 dark:bg-slate-900 p-4 rounded-lg border border-slate-200 dark:border-slate-800 mb-4">
                        <h4 class="font-bold text-sm text-slate-900 dark:text-slate-300 mb-2">Detailed Real World
                            Example: Social Media Feeds (e.g., Twitter/X)</h4>
                        <p class="text-xs text-slate-500 dark:text-slate-400">
                            When you load a tweet, you don't want the database to join 5 tables (User, Tweet, Likes,
                            Hashtags).<br>
                            Instead, the tweet is stored as one <strong>JSON Document</strong> containing the text, the
                            author info, and the first few comments embedded directly inside it. This allows the app to
                            load the data in one single fetch.
                        </p>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 rounded bg-green-100 dark:bg-green-900/50 text-green-600 dark:text-green-400 flex items-center justify-center flex-shrink-0">
                            <i data-lucide="check" class="w-3 h-3"></i>
                        </div>
                        <div>
                            <span class="font-bold text-sm text-slate-900 dark:text-white">Pros</span>
                            <p class="text-xs text-slate-500 dark:text-slate-400">Flexible Schema (add fields anytime).
                                Horizontal Scalability. Fast read/write for specific objects.</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3">
                        <div
                            class="w-6 h-6 rounded bg-red-100 dark:bg-red-900/50 text-red-600 dark:text-red-400 flex items-center justify-center flex-shrink-0">
                            <i data-lucide="x" class="w-3 h-3"></i>
                        </div>
                        <div>
                            <span class="font-bold text-sm text-slate-900 dark:text-white">Cons</span>
                            <p class="text-xs text-slate-500 dark:text-slate-400">Data duplication (denormalization).
                                Weaker consistency (Eventual Consistency) compared to SQL.</p>
                        </div>
                    </div>
                </div>
            </div>

        </section>

    </main>

    <footer
        class="border-t border-slate-200 dark:border-slate-800 py-8 text-center text-slate-500 text-sm bg-slate-50 dark:bg-slate-950 transition-colors">
        <p>Interactive Computer Science Module â€¢ Designed with Tailwind & GSAP</p>
    </footer>

    <script>
        // Init Icons
        lucide.createIcons();

        // ------------------------------------------
        // DATA & CONFIG
        // ------------------------------------------

        const nodesData = [
            { id: 'root', label: 'Company', icon: 'building-2', color: 'bg-emerald-600' },
            { id: 'dept1', label: 'Engineering', icon: 'cpu', color: 'bg-slate-600' },
            { id: 'dept2', label: 'HR', icon: 'users', color: 'bg-slate-600' },
            { id: 'emp1', label: 'Dev. Alice', icon: 'user', color: 'bg-brand-600' },
            { id: 'emp2', label: 'Dev. Bob', icon: 'user', color: 'bg-brand-600' },
            { id: 'proj1', label: 'Project X', icon: 'box', color: 'bg-purple-600' },
        ];

        // Layout Configs (Top%, Left%)
        const layouts = {
            hierarchical: {
                root: { top: 10, left: 45 },
                dept1: { top: 35, left: 25 },
                dept2: { top: 35, left: 65 },
                emp1: { top: 60, left: 15 },
                emp2: { top: 60, left: 35 },
                proj1: { top: 85, left: 15 } // Deep nested
            },
            network: {
                root: { top: 10, left: 45 },
                dept1: { top: 35, left: 30 },
                dept2: { top: 35, left: 60 },
                emp1: { top: 65, left: 20 },
                emp2: { top: 65, left: 50 },
                proj1: { top: 50, left: 45 } // Shared resource
            },
            relational: {
                // Arranged as separate columns
                root: { top: 15, left: 15 },
                dept1: { top: 40, left: 15 },
                dept2: { top: 65, left: 15 },

                emp1: { top: 15, left: 45 },
                emp2: { top: 40, left: 45 },

                proj1: { top: 15, left: 75 }
            },
            nosql: {
                // Clustered Documents. We will simulate "Buckets" visually by proximity
                root: { top: 20, left: 20 }, // Document A (Company Info)

                // Document B (Dept 1 + Emp 1 + Proj 1 Denormalized)
                dept1: { top: 20, left: 60 },
                emp1: { top: 35, left: 60 },
                proj1: { top: 50, left: 60 },

                // Document C (Dept 2 + Emp 2)
                dept2: { top: 65, left: 20 },
                emp2: { top: 80, left: 20 },
            }
        };

        // Connections [Source, Target]
        const connections = {
            hierarchical: [
                ['root', 'dept1'], ['root', 'dept2'],
                ['dept1', 'emp1'], ['dept1', 'emp2'],
                ['emp1', 'proj1']
            ],
            network: [
                ['root', 'dept1'], ['root', 'dept2'],
                ['dept1', 'emp1'], ['dept1', 'proj1'],
                ['dept2', 'emp2'], ['dept2', 'proj1'],
                ['emp2', 'proj1']
            ],
            relational: [
                ['root', 'dept1'], ['root', 'dept2'],
                ['dept1', 'emp1'], ['dept1', 'emp2'],
                ['dept1', 'proj1'], ['dept2', 'proj1']
            ],
            nosql: [
                // NoSQL usually doesn't have visible "lines" between documents in the same way, 
                // but we will draw lines to show containment within the "Cluster"
                ['dept1', 'emp1'], ['dept1', 'proj1'], // Cluster 1
                ['dept2', 'emp2'] // Cluster 2
                // Note: No connection between Cluster 1 and Cluster 2 or Root really.
            ]
        };

        // Metrics Data
        const metrics = {
            hierarchical: {
                compVal: "Low", compBar: "20%",
                flexVal: "Rigid", flexBar: "10%",
                code: `
{
  "Company": {
    "Engineering": {
       "Alice": { "ProjectX": {} }
    }
  }
}
                `,
                title: "Hierarchical Model", desc: "Data is nested like folders. You must drill down."
            },
            network: {
                compVal: "High", compBar: "80%",
                flexVal: "Medium", flexBar: "50%",
                code: `
HEAD -> Company
Company.next -> Engineering
Engineering.owner -> Company
Engineering.member -> ProjectX
HR.member -> ProjectX
                `,
                title: "Network Model", desc: "Entities connected in a mesh. 'Project X' has multiple parents."
            },
            relational: {
                compVal: "Medium", compBar: "50%",
                flexVal: "High", flexBar: "95%",
                code: `
SELECT * FROM Projects 
JOIN Dept ON Projects.DeptID = Dept.ID
WHERE ProjectName = 'Project X'
                `,
                title: "Relational Model", desc: "Independent tables linked by logical Foreign Keys (dashed lines)."
            },
            nosql: {
                compVal: "Very Low", compBar: "10%",
                flexVal: "Very High", flexBar: "100%",
                code: `
// Document: Engineering
{
  "Dept": "Engineering",
  "Employees": [ "Alice", "Bob" ],
  "Projects": [ "Project X" ]
}
                `,
                title: "NoSQL (Document)", desc: "Data is grouped into self-contained documents (Clusters). 'Project X' is stored DIRECTLY inside Engineering."
            }
        };

        // Query Paths
        const queryPaths = {
            hierarchical: ['root', 'dept1', 'emp1', 'proj1'],
            network: ['root', 'dept1', 'proj1'],
            relational: ['dept1', 'proj1'],
            nosql: ['dept1', 'proj1'] // Fast access because it's in the same "Document"
        };

        // ------------------------------------------
        // ENGINE
        // ------------------------------------------

        let currentMode = 'hierarchical';
        let nodesElements = {};
        const canvas = document.getElementById('canvas');
        const svgLayer = document.getElementById('connections');

        // Initialize Nodes
        function initNodes() {
            nodesData.forEach(node => {
                const el = document.createElement('div');
                el.id = node.id;
                el.className = `absolute flex flex-col items-center justify-center w-24 h-16 ${node.color} text-white rounded-lg shadow-lg z-10 border border-white/20 transition-transform hover:scale-105 cursor-default select-none`;

                el.innerHTML = `
                    <i data-lucide="${node.icon}" class="w-5 h-5 mb-1"></i>
                    <span class="font-bold text-[10px]">${node.label}</span>
                `;

                canvas.appendChild(el);
                nodesElements[node.id] = el;
            });
            lucide.createIcons();
        }

        function getCenter(el) {
            const rect = el.getBoundingClientRect();
            const canvasRect = canvas.getBoundingClientRect();
            return {
                x: (rect.left - canvasRect.left) + rect.width / 2,
                y: (rect.top - canvasRect.top) + rect.height / 2
            };
        }

        function drawConnections() {
            svgLayer.innerHTML = '';
            const links = connections[currentMode];
            const isRelational = currentMode === 'relational';
            const isNoSQL = currentMode === 'nosql';

            links.forEach(([startId, endId]) => {
                const startEl = nodesElements[startId];
                const endEl = nodesElements[endId];

                const start = getCenter(startEl);
                const end = getCenter(endEl);

                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');

                line.setAttribute('x1', start.x);
                line.setAttribute('y1', start.y);
                line.setAttribute('x2', end.x);
                line.setAttribute('y2', end.y);

                if (isRelational) {
                    line.setAttribute('stroke', '#6366f1');
                    line.setAttribute('stroke-dasharray', '5,5');
                    line.setAttribute('stroke-width', '2');
                    line.setAttribute('opacity', '0.6');
                } else if (isNoSQL) {
                    // In NoSQL, visualize "Container" boundaries or hierarchy links
                    line.setAttribute('stroke', '#f59e0b');
                    line.setAttribute('stroke-width', '4');
                    line.setAttribute('opacity', '0.2');
                } else {
                    const isDark = document.documentElement.classList.contains('dark');
                    line.setAttribute('stroke', isDark ? '#475569' : '#cbd5e1'); // Slate 600 dark, 300 light
                    line.setAttribute('stroke-width', '2');
                }

                svgLayer.appendChild(line);
            });
        }

        function setMode(mode) {
            currentMode = mode;

            // 1. Visual Selection of Buttons
            document.querySelectorAll('.model-btn').forEach(btn => {
                btn.classList.remove('active'); // Remove Custom Active Class
                btn.classList.remove('bg-slate-100', 'dark:bg-slate-800', 'border-slate-300', 'dark:border-slate-700'); // Remove utility classes
            });

            const activeBtn = document.getElementById(`btn-${mode}`);
            activeBtn.classList.add('active'); // Add Custom Active Class

            // 2. Animate Nodes
            const layout = layouts[mode];
            nodesData.forEach(node => {
                const target = layout[node.id];
                gsap.to(nodesElements[node.id], {
                    top: target.top + "%",
                    left: target.left + "%",
                    duration: 0.8,
                    ease: "power3.inOut",
                    onUpdate: drawConnections
                });
            });

            // 3. Update Text & Code
            const m = metrics[mode];
            document.getElementById('sim-title').innerText = m.title;
            document.getElementById('sim-desc').innerText = m.desc;
            document.getElementById('code-preview').innerText = m.code.trim();

            // 4. Update Metrics Bars
            document.getElementById('metric-complexity-val').innerText = m.compVal;
            document.getElementById('metric-complexity-bar').style.width = m.compBar;
            document.getElementById('metric-flex-val').innerText = m.flexVal;
            document.getElementById('metric-flex-bar').style.width = m.flexBar;
        }

        // ------------------------------------------
        // SIMULATION
        // ------------------------------------------
        let isSimulating = false;

        function runQuery() {
            if (isSimulating) return;
            isSimulating = true;

            const btn = document.getElementById('btn-query');
            const status = document.getElementById('query-status');
            const packet = document.getElementById('packet');

            btn.disabled = true;
            status.style.opacity = 1;
            packet.style.display = 'block';

            const pathIds = queryPaths[currentMode];
            let timeline = gsap.timeline({
                onComplete: () => {
                    isSimulating = false;
                    btn.disabled = false;
                    status.style.opacity = 0;
                    packet.style.display = 'none';
                }
            });

            // Set initial position
            const startNode = nodesElements[pathIds[0]];
            const startPos = getCenter(startNode);
            gsap.set(packet, { left: startPos.x, top: startPos.y });

            // Create waypoints
            for (let i = 1; i < pathIds.length; i++) {
                const nextNode = nodesElements[pathIds[i]];
                const nextPos = getCenter(nextNode);

                timeline.to(packet, {
                    left: nextPos.x,
                    top: nextPos.y,
                    duration: 0.8,
                    ease: "power1.inOut"
                });

                timeline.to(nextNode, {
                    scale: 1.2,
                    duration: 0.2,
                    yoyo: true,
                    repeat: 1
                }, "<+0.4");
            }
        }

        // ------------------------------------------
        // TABS LOGIC
        // ------------------------------------------
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');

            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-brand-500', 'text-slate-900', 'dark:text-white');
                btn.classList.add('border-transparent', 'text-slate-500');
            });
            event.target.classList.remove('border-transparent', 'text-slate-500');
            event.target.classList.add('border-brand-500', 'text-slate-900', 'dark:text-white');
        }

        // ------------------------------------------
        // THEME TOGGLE
        // ------------------------------------------
        function toggleTheme() {
            const html = document.documentElement;
            if (html.classList.contains('dark')) {
                html.classList.remove('dark');
            } else {
                html.classList.add('dark');
            }
            // Trigger redraw for line colors
            setTimeout(drawConnections, 100);
        }

        // ------------------------------------------
        // INIT
        // ------------------------------------------
        window.addEventListener('resize', () => {
            setMode(currentMode);
        });

        initNodes();
        // Delay slightly for DOM calculation
        setTimeout(() => {
            setMode('hierarchical');
        }, 100);

    </script>
</body>

</html>