<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Statistical Language Modeling — Paper X</title>
    <link rel="icon" type="image/x-icon" href="../../../assets/img/favicon.svg">

    <!-- Inter + JetBrains Mono + Material Symbols -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;700&family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,600,0,0"
        rel="stylesheet">

    <!-- Tailwind CSS bundle used across Paper X -->
    <link rel="stylesheet" href="../../../assets/css/tailwind.css" />

    <!-- MathJax for formula rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                container: { center: true, padding: '1rem' },
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'ui-sans-serif', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace']
                    },
                    colors: {
                        brand: { 900: '#1E1E2F', 700: '#4C2A59', 500: '#9E4B8A' },
                        brandlt: {
                            50: '#FAF5FB',
                            100: '#F3E7F2',
                            200: '#E7D0E4',
                            300: '#D9B4D3',
                            400: '#C88DBA',
                            500: '#9E4B8A',
                            700: '#4C2A59',
                            900: '#1E1E2F'
                        }
                    },
                    boxShadow: {
                        glow: '0 8px 30px rgba(158,75,138,0.35)',
                        soft: '0 10px 30px rgba(0,0,0,0.25)',
                        card: '0 24px 60px rgba(30,30,47,0.35)'
                    },
                    backgroundImage: {
                        'hero-dark': 'radial-gradient(900px 520px at 50% -15%, rgba(158,75,138,0.35), transparent 65%), linear-gradient(180deg,#1E1E2F 0%,#201934 55%,#141321 100%)',
                        'hero-light': 'radial-gradient(1000px 560px at 50% -18%, rgba(158,75,138,0.18), transparent 62%), linear-gradient(180deg,#FFFFFF 0%,#FBF8FC 55%,#F7F2F9 100%)'
                    }
                }
            }
        }
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --bg-app: #F7F2F9;
            --bg-card: #FFFFFF;
            --text-head: #1E1E2F;
            --text-body: #2F2F3A;
            --text-sub: #5A5A6B;
            --border: #E5DFEC;
            --brand-500: #9E4B8A;
            --brand-700: #4C2A59;
            --brand-900: #1E1E2F;
        }

        .dark {
            --bg-app: #1E1E2F;
            --bg-card: #201934;
            --text-head: #F3E7F2;
            --text-body: #E8E3EE;
            --text-sub: #C9BED5;
            --border: #3A3247;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
        }

        .lab-shell {
            min-height: 100vh;
            background-image: linear-gradient(180deg, #FFFFFF 0%, #FBF8FC 45%, #F7F2F9 100%);
        }

        .dark .lab-shell {
            background-image: linear-gradient(180deg, #1E1E2F 0%, #201934 55%, #141321 100%);
        }

        /* Glassmorphism Panels */
        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(158, 75, 138, 0.15);
            box-shadow: 0 8px 32px rgba(30, 30, 47, 0.12);
        }

        .dark .glass-panel {
            background: rgba(30, 30, 47, 0.75);
            border: 1px solid rgba(200, 141, 186, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.35);
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(158, 75, 138, 0.12);
            transition: transform 0.2s ease, border-color 0.2s;
        }

        .dark .glass-card {
            background: rgba(30, 30, 47, 0.85);
            border: 1px solid rgba(200, 141, 186, 0.25);
        }

        .glass-card:hover {
            border-color: rgba(158, 75, 138, 0.4);
            transform: translateY(-2px);
        }

        /* Hero Section Text */
        .gradient-hero-text {
            display: inline-block;
            background-image: linear-gradient(90deg, #1E1E2F, #4C2A59, #9E4B8A, #4C2A59, #1E1E2F);
            background-size: 200% 200%;
            animation: gradient-shift 4s ease-in-out infinite;
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .dark .gradient-hero-text {
            background-image: linear-gradient(90deg, #EFA3DC, #CA6CB3, #FFFFFF, #CA6CB3, #EFA3DC);
        }

        @keyframes gradient-shift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        /* Pulse animation for floating blobs */
        @keyframes pulse-slow {

            0%,
            100% {
                opacity: 0.15;
                transform: scale(1);
            }

            50% {
                opacity: 0.25;
                transform: scale(1.05);
            }
        }

        .animate-pulse-slow {
            animation: pulse-slow 6s ease-in-out infinite;
        }

        /* Range Slider Styling */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #9E4B8A 0%, #B06AB3 100%);
            cursor: pointer;
            margin-top: -7px;
            box-shadow: 0 0 12px rgba(158, 75, 138, 0.6);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #E7D0E4;
            border-radius: 2px;
        }

        .dark input[type=range]::-webkit-slider-runnable-track {
            background: #4C2A59;
        }

        /* Bar Container Styling */
        .bar-container {
            transition: all 0.3s ease;
        }

        .bar-container:hover {
            transform: scale(1.05);
        }

        /* Probability Bar */
        .probability-bar {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .probability-bar.high {
            background: linear-gradient(180deg, #10b981 0%, #059669 100%);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }

        .probability-bar.medium {
            background: linear-gradient(180deg, #9E4B8A 0%, #B06AB3 100%);
            box-shadow: 0 0 15px rgba(158, 75, 138, 0.4);
        }

        .probability-bar.low {
            background: linear-gradient(180deg, #4C2A59 0%, #5A3468 100%);
        }

        /* Word Token */
        .word-token {
            background: linear-gradient(135deg, rgba(158, 75, 138, 0.1) 0%, rgba(76, 42, 89, 0.1) 100%);
            border: 1px solid rgba(158, 75, 138, 0.3);
            animation: slideIn 0.3s ease-out;
        }

        .dark .word-token {
            background: linear-gradient(135deg, rgba(158, 75, 138, 0.2) 0%, rgba(76, 42, 89, 0.2) 100%);
            border: 1px solid rgba(200, 141, 186, 0.4);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px) scale(0.9);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(158, 75, 138, 0.3);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(158, 75, 138, 0.5);
        }

        /* Chip Button */
        .chip-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(158, 75, 138, 0.2);
            color: #4C2A59;
            transition: all 0.2s ease;
        }

        .dark .chip-btn {
            background: rgba(30, 30, 47, 0.8);
            border: 1px solid rgba(200, 141, 186, 0.3);
            color: #E7D0E4;
        }

        .chip-btn:hover {
            border-color: #9E4B8A;
            background: rgba(158, 75, 138, 0.1);
        }

        .chip-btn.active {
            background: linear-gradient(135deg, #9E4B8A 0%, #B06AB3 100%);
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 20px rgba(158, 75, 138, 0.5);
        }

        /* Formula container */
        .formula-container {
            background: linear-gradient(135deg, rgba(250, 245, 251, 0.95) 0%, rgba(243, 231, 242, 0.95) 100%);
            border: 1px solid rgba(158, 75, 138, 0.2);
        }

        .dark .formula-container {
            background: linear-gradient(135deg, rgba(30, 30, 47, 0.95) 0%, rgba(40, 30, 55, 0.95) 100%);
            border: 1px solid rgba(200, 141, 186, 0.3);
        }

        /* Context chip */
        .context-chip {
            background: linear-gradient(135deg, rgba(158, 75, 138, 0.15) 0%, rgba(76, 42, 89, 0.15) 100%);
            border: 1px solid rgba(158, 75, 138, 0.3);
        }

        .dark .context-chip {
            background: linear-gradient(135deg, rgba(158, 75, 138, 0.25) 0%, rgba(76, 42, 89, 0.25) 100%);
            border: 1px solid rgba(200, 141, 186, 0.4);
        }
    </style>

    <!-- Persist theme before paint -->
    <script>
            (function () {
                try {
                    const s = localStorage.getItem('px_theme');
                    const prefers = window.matchMedia('(prefers-color-scheme: dark)').matches;
                    const useDark = s ? s === 'dark' : prefers;
                    if (useDark) document.documentElement.classList.add('dark');
                } catch (_) { }
            })();
    </script>
    <script src="../../../config.js"></script>
</head>

<body class="min-h-screen font-sans antialiased text-neutral-900 dark:text-white bg-hero-light dark:bg-hero-dark">

    <!-- ============== NAVBAR (Paper X) ============== -->
    <header
        class="sticky top-0 z-50 bg-white/80 dark:bg-brand-900/70 backdrop-blur supports-[backdrop-filter]:saturate-150 border-b border-black/5 dark:border-white/10">
        <div class="container flex items-center justify-between py-3.5">
            <a href="../../../index.html" class="flex items-center gap-3 shrink-0" aria-label="Paper X Home">
                <img src="../../../assets/img/logo-light.svg" class="h-9 w-auto dark:hidden" alt="Paper X" />
                <img src="../../../assets/img/logo-dark.svg" class="h-9 w-auto hidden dark:block" alt="Paper X" />
            </a>
            <nav class="hidden md:flex items-center gap-6 text-sm text-neutral-700 dark:text-white/85">
                <a href="../../../index.html" class="hover:text-brandlt-900 dark:hover:text-white">Home</a>
                <a href="../../../about.html" class="hover:text-brandlt-900 dark:hover:text-white">About</a>
                <a href="../../../academicas.html" class="hover:text-brandlt-900 dark:hover:text-white">Academics</a>
                <a href="../../../contact.html" class="hover:text-brandlt-900 dark:hover:text-white">Support</a>
            </nav>
            <div class="hidden md:flex items-center gap-2">
                <button data-theme-toggle
                    class="inline-flex items-center gap-2 rounded-full px-3 py-2 text-sm ring-1 ring-black/10 dark:ring-white/15 hover:bg-black/5 dark:hover:bg-white/5"
                    aria-label="Toggle theme">
                    <span class="material-symbols-rounded dark:hidden">dark_mode</span>
                    <span class="material-symbols-rounded hidden dark:inline">light_mode</span>
                    <span class="hidden lg:block">Theme</span>
                </button>
                <a href="../../../login.html"
                    class="px-3 py-2 text-sm text-neutral-700 dark:text-white/80 hover:text-brandlt-900 dark:hover:text-white rounded-full">Log
                    in</a>
                <a href="../../../signup.html"
                    class="inline-flex items-center justify-center rounded-full bg-brand-500 text-white text-sm font-semibold px-4 py-2.5 hover:shadow-glow transition">Sign
                    up</a>
            </div>
            <div class="md:hidden flex items-center gap-2">
                <button type="button" data-theme-toggle aria-label="Toggle theme"
                    class="inline-flex items-center justify-center size-10 rounded-full ring-1 ring-black/10 dark:ring-white/15 hover:bg-black/5 dark:hover:bg-white/5 transition">
                    <span class="material-symbols-rounded dark:hidden">dark_mode</span>
                    <span class="material-symbols-rounded hidden dark:inline">light_mode</span>
                </button>
            </div>
        </div>
    </header>

    <main class="lab-shell pb-10">
        <!-- Hero Section -->
        <section class="relative pt-16 pb-12 overflow-hidden">
            <!-- Floating background blobs -->
            <div class="absolute inset-0 overflow-hidden pointer-events-none">
                <div
                    class="absolute top-1/4 left-1/4 w-96 h-96 bg-brand-500 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[100px] animate-pulse-slow">
                </div>
                <div class="absolute bottom-1/4 right-1/4 w-72 h-72 bg-brand-700 rounded-full mix-blend-multiply dark:mix-blend-screen filter blur-[80px] animate-pulse-slow"
                    style="animation-delay: -3s;">
                </div>
            </div>

            <div class="container max-w-4xl mx-auto px-4 text-center relative z-10">
                <div
                    class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-brand-500/10 border border-brand-500/20 text-brand-500 dark:text-brandlt-400 text-xs tracking-widest uppercase font-bold mb-6">
                    <i data-lucide="message-square-text" class="w-3.5 h-3.5"></i>
                    Natural Language Processing
                </div>

                <h1 class="text-4xl md:text-6xl font-extrabold tracking-tight gradient-hero-text mb-6">
                    Statistical Language Modeling
                </h1>

                <p
                    class="text-lg md:text-xl text-neutral-600 dark:text-white/70 leading-relaxed font-light max-w-2xl mx-auto mb-8">
                    Imagine you're at a loud dinner party. You only hear half of what your friend says:
                    <br><br>
                    <span class="italic text-brand-900 dark:text-white font-medium">"Please pass the..."</span>
                </p>

                <div class="glass-panel p-6 rounded-2xl max-w-xl mx-auto">
                    <p class="text-neutral-600 dark:text-white/70 mb-4">Your brain instantly guesses the next word:</p>
                    <div class="flex flex-wrap justify-center gap-3">
                        <span
                            class="px-4 py-2 bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 rounded-xl font-bold border border-emerald-500/30">
                            Salt (80%)
                        </span>
                        <span
                            class="px-4 py-2 bg-amber-500/20 text-amber-600 dark:text-amber-400 rounded-xl font-bold border border-amber-500/30">
                            Butter (15%)
                        </span>
                        <span
                            class="px-4 py-2 bg-red-500/20 text-red-500 dark:text-red-400 rounded-xl font-bold border border-red-500/30">
                            Elephant (0%)
                        </span>
                    </div>
                    <p class="text-neutral-500 dark:text-white/50 text-sm mt-4">
                        You didn't use magic. You used <strong
                            class="text-brand-900 dark:text-white">statistics</strong>
                        based on your life experience (data).
                    </p>
                </div>

                <div class="mt-10 animate-bounce text-neutral-400 dark:text-white/40">
                    <i data-lucide="chevron-down" class="w-6 h-6 mx-auto"></i>
                </div>
            </div>
        </section>

        <!-- Interactive Simulator Section -->
        <section class="py-10 px-4 md:px-8" id="lab">
            <div class="max-w-7xl mx-auto">
                <div class="flex items-center gap-4 mb-8">
                    <div class="p-3 bg-brand-500/20 rounded-xl text-brand-500 dark:text-brandlt-400">
                        <i data-lucide="cpu" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold text-brand-900 dark:text-white">The Probability Engine
                        </h2>
                        <p class="text-neutral-600 dark:text-white/60">Interact with this "Toy Model." It learns from
                            the small <strong>Corpus</strong> on the left.</p>
                    </div>
                </div>

                <div class="grid lg:grid-cols-12 gap-8 items-start">
                    <!-- Controls Panel -->
                    <div class="lg:col-span-4 space-y-6">
                        <!-- Training Corpus Card -->
                        <div class="glass-panel p-6 rounded-2xl">
                            <div class="flex items-center gap-2 mb-4 border-b border-black/5 dark:border-white/10 pb-4">
                                <i data-lucide="database" class="w-4 h-4 text-brand-500"></i>
                                <h3
                                    class="text-sm font-bold uppercase tracking-wider text-neutral-600 dark:text-white/70">
                                    1. Training Corpus</h3>
                            </div>
                            <p class="text-xs text-neutral-500 dark:text-white/50 mb-3">The model has ONLY read this
                                text:</p>
                            <div
                                class="bg-brandlt-50 dark:bg-white/5 p-4 rounded-xl border border-brand-500/10 dark:border-white/10 font-mono text-sm text-neutral-700 dark:text-white/80 leading-relaxed relative">
                                <div class="absolute top-2 right-2 opacity-40">
                                    <i data-lucide="book-open" class="w-4 h-4"></i>
                                </div>
                                <p id="corpus-text">
                                    the cat sat on the mat .
                                    the dog sat on the log .
                                    the cat saw the dog .
                                    the dog saw the cat .
                                    the cat ate the mouse .
                                </p>
                            </div>
                        </div>

                        <!-- Model Depth Control -->
                        <div class="glass-panel p-6 rounded-2xl">
                            <div class="flex items-center gap-2 mb-4 border-b border-black/5 dark:border-white/10 pb-4">
                                <i data-lucide="settings-2" class="w-4 h-4 text-brand-500"></i>
                                <h3
                                    class="text-sm font-bold uppercase tracking-wider text-neutral-600 dark:text-white/70">
                                    2. Model Depth (N-Gram)</h3>
                            </div>
                            <input type="range" min="1" max="3" value="2" id="ngram-slider" class="w-full mb-4">
                            <div class="flex justify-between text-xs font-mono mb-4">
                                <span id="label-1"
                                    class="chip-btn px-2 py-1 rounded-lg cursor-pointer transition">Unigram</span>
                                <span id="label-2"
                                    class="chip-btn active px-2 py-1 rounded-lg cursor-pointer transition">Bigram</span>
                                <span id="label-3"
                                    class="chip-btn px-2 py-1 rounded-lg cursor-pointer transition">Trigram</span>
                            </div>
                            <p class="text-xs text-neutral-500 dark:text-white/50 leading-relaxed" id="slider-desc">
                                Looks at the <strong>previous word</strong>. Makes local sense, but no long-term memory.
                            </p>
                        </div>
                    </div>

                    <!-- Sentence Builder Panel -->
                    <div class="lg:col-span-8 space-y-6">
                        <div class="glass-panel p-8 rounded-2xl min-h-[520px] flex flex-col relative">
                            <!-- Header -->
                            <div
                                class="flex items-center justify-between mb-6 border-b border-black/5 dark:border-white/10 pb-4">
                                <div class="flex items-center gap-2 text-brand-500 dark:text-brandlt-400">
                                    <i data-lucide="play-circle" class="w-5 h-5"></i>
                                    <h3 class="font-bold text-sm tracking-wider uppercase">3. Sentence Builder</h3>
                                </div>
                                <button onclick="resetSimulation()"
                                    class="inline-flex items-center gap-2 text-xs bg-brand-500/10 hover:bg-brand-500/20 text-brand-500 dark:text-brandlt-400 px-4 py-2 rounded-lg transition font-semibold">
                                    <i data-lucide="rotate-ccw" class="w-3 h-3"></i>
                                    Reset
                                </button>
                            </div>

                            <!-- Sentence Display -->
                            <div class="mb-8">
                                <p class="text-xs text-neutral-400 dark:text-white/40 mb-3 italic">Click a predicted bar
                                    below to add word</p>
                                <div id="sentence-container"
                                    class="flex flex-wrap items-center gap-2 text-xl md:text-2xl font-medium min-h-[3.5rem]">
                                </div>
                                <div
                                    class="h-1.5 w-full bg-brandlt-100 dark:bg-white/10 mt-4 rounded-full overflow-hidden">
                                    <div id="progress-bar"
                                        class="h-full bg-gradient-to-r from-brand-500 to-brand-700 w-0 transition-all duration-500 rounded-full">
                                    </div>
                                </div>
                            </div>

                            <!-- Chart Area -->
                            <div class="flex-grow flex flex-col justify-end">
                                <div
                                    class="flex justify-between items-end mb-3 text-xs text-neutral-500 dark:text-white/50 uppercase tracking-widest">
                                    <span class="flex items-center gap-2">
                                        <i data-lucide="bar-chart-3" class="w-3 h-3"></i>
                                        Next Word Probability Distribution
                                    </span>
                                    <span id="context-monitor"
                                        class="context-chip px-3 py-1 rounded-full font-mono text-brand-500 dark:text-brandlt-400">Context:
                                        "[Start]"</span>
                                </div>

                                <div id="chart-container"
                                    class="h-56 w-full flex items-end gap-3 border-b border-brand-500/20 dark:border-white/20 pb-2 overflow-x-auto">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Under The Hood Section -->
        <section class="py-16 px-6 max-w-6xl mx-auto">
            <div class="mb-12 border-l-4 border-brand-500 pl-6">
                <h2 class="text-3xl md:text-4xl font-bold text-brand-900 dark:text-white mb-2 flex items-center gap-3">
                    <span class="text-brand-500">
                        <i data-lucide="cpu" class="w-8 h-8"></i>
                    </span>
                    Under The Hood
                </h2>
                <p class="text-neutral-600 dark:text-white/60">The mathematics and intuition behind language models.
                </p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Conditional Probability Card -->
                <div class="glass-card p-6 rounded-2xl lg:col-span-2">
                    <div
                        class="w-12 h-12 rounded-xl bg-brand-500/20 flex items-center justify-center mb-4 text-brand-500">
                        <i data-lucide="sigma" class="w-6 h-6"></i>
                    </div>
                    <h3 class="text-lg font-bold text-brand-900 dark:text-white mb-2">Conditional Probability</h3>
                    <p class="text-sm text-neutral-600 dark:text-white/60 leading-relaxed mb-4">
                        The model isn't "thinking." It's just counting. It calculates the probability \( P \) of a word
                        \( w \) appearing, given the history \( h \).
                    </p>
                    <div class="formula-container p-5 rounded-xl text-center overflow-x-auto">
                        <div class="text-brand-900 dark:text-white text-lg">
                            \[ P(w_n \mid w_{n-N+1} \ldots w_{n-1}) = \frac{\text{Count}(\text{history} +
                            w_n)}{\text{Count}(\text{history})} \]
                        </div>
                    </div>
                    <p class="text-xs text-neutral-500 dark:text-white/50 mt-4 italic">
                        In simple terms: If we see "The cat", how many times did "sat" come next vs. "ate"?
                    </p>
                </div>

                <!-- N-Gram Card -->
                <div class="glass-card p-6 rounded-2xl">
                    <div
                        class="w-12 h-12 rounded-xl bg-brand-700/20 flex items-center justify-center mb-4 text-brand-700 dark:text-brandlt-400">
                        <i data-lucide="layers" class="w-6 h-6"></i>
                    </div>
                    <h3 class="text-lg font-bold text-brand-900 dark:text-white mb-4">What is an N-Gram?</h3>
                    <ul class="space-y-3 text-sm text-neutral-600 dark:text-white/60">
                        <li class="flex items-start gap-3">
                            <span class="w-3 h-3 rounded-full bg-red-400 mt-1 shrink-0"></span>
                            <span><strong class="text-brand-900 dark:text-white">Unigram (N=1):</strong> "Random word
                                soup." No context.</span>
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="w-3 h-3 rounded-full bg-amber-400 mt-1 shrink-0"></span>
                            <span><strong class="text-brand-900 dark:text-white">Bigram (N=2):</strong> Looks at 1
                                previous word.</span>
                        </li>
                        <li class="flex items-start gap-3">
                            <span class="w-3 h-3 rounded-full bg-emerald-400 mt-1 shrink-0"></span>
                            <span><strong class="text-brand-900 dark:text-white">Trigram (N=3):</strong> Looks at 2
                                previous words. Coherent snippets.</span>
                        </li>
                    </ul>
                </div>

                <!-- Sparsity Card -->
                <div class="glass-card p-6 rounded-2xl">
                    <div
                        class="w-12 h-12 rounded-xl bg-brand-900/10 dark:bg-white/10 flex items-center justify-center mb-4 text-brand-900 dark:text-white">
                        <i data-lucide="alert-triangle" class="w-6 h-6"></i>
                    </div>
                    <h3 class="text-lg font-bold text-brand-900 dark:text-white mb-2">The Problem of Sparsity</h3>
                    <p class="text-sm text-neutral-600 dark:text-white/60 leading-relaxed">
                        Did you notice that with <strong>Trigrams</strong>, sometimes there were no suggestions?
                        <br><br>
                        If the model hasn't seen the exact sequence "cat ate the" in the training data, it has 0%
                        probability for the next word. This is why LLMs (like GPT) need massive amounts of data.
                    </p>
                </div>

                <!-- From N-Grams to ChatGPT -->
                <div
                    class="glass-card p-6 rounded-2xl lg:col-span-2 bg-gradient-to-br from-brand-500/10 to-brand-700/10">
                    <div
                        class="w-12 h-12 rounded-xl bg-brand-500/30 flex items-center justify-center mb-4 text-brand-500">
                        <i data-lucide="sparkles" class="w-6 h-6"></i>
                    </div>
                    <h3 class="text-lg font-bold text-brand-900 dark:text-white mb-2">From This to ChatGPT</h3>
                    <p class="text-sm text-neutral-600 dark:text-white/60 leading-relaxed mb-4">
                        Modern LLMs (Large Language Models) use the same core principle: <strong>predict the next
                            token</strong>.
                        However, instead of simple counting (N-Grams), they use <strong>Neural Networks</strong>
                        (Transformers).
                    </p>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="border-l-2 border-brand-500 pl-4">
                            <span
                                class="block text-xs text-neutral-500 dark:text-white/50 uppercase tracking-wider mb-1">N-Grams</span>
                            <span class="text-sm text-brand-900 dark:text-white">Memorizes exact phrases.</span>
                        </div>
                        <div class="border-l-2 border-emerald-500 pl-4">
                            <span
                                class="block text-xs text-neutral-500 dark:text-white/50 uppercase tracking-wider mb-1">Neural
                                Nets</span>
                            <span class="text-sm text-brand-900 dark:text-white">Understands vague concepts &
                                patterns.</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer
        class="text-center py-12 text-neutral-500 dark:text-white/40 text-sm border-t border-black/5 dark:border-white/10">
        <p>Designed for Interactive Learning — Paper X Labs</p>
    </footer>

    <script>
        // Initialize Lucide Icons
        lucide.createIcons();

        // --- Theme Toggle ---
        const themeToggles = document.querySelectorAll('[data-theme-toggle]');
        themeToggles.forEach(btn => {
            btn.addEventListener('click', () => {
                const html = document.documentElement;
                const isDark = html.classList.toggle('dark');
                localStorage.setItem('px_theme', isDark ? 'dark' : 'light');
            });
        });

        // --- 1. DATA & STATE ---

        // The Training Data (Corpus) - pre-tokenized for simplicity
        const rawText = "the cat sat on the mat . the dog sat on the log . the cat saw the dog . the dog saw the cat . the cat ate the mouse .";
        const tokens = rawText.split(/\s+/).filter(t => t.length > 0);

        // Simulation State
        let state = {
            n: 2, // 1=Unigram, 2=Bigram, 3=Trigram
            history: [], // Current words in the sentence builder
            vocab: [...new Set(tokens)].sort()
        };

        // --- 2. ENGINE LOGIC ---

        // Helper: Get n-grams from tokens
        function getNGrams(n, tokenList) {
            const grams = {};
            for (let i = 0; i <= tokenList.length - n; i++) {
                // The history (prefix)
                const prefix = tokenList.slice(i, i + n - 1).join(" ");
                // The next word (target)
                const target = tokenList[i + n - 1];

                if (!grams[prefix]) grams[prefix] = {};
                if (!grams[prefix][target]) grams[prefix][target] = 0;
                grams[prefix][target]++;
            }
            return grams;
        }

        // Calculate Probabilities based on current history and N settings
        function calculateNextWordProbs() {
            let context = "";

            if (state.n === 1) {
                context = ""; // Unigram has no context
            } else if (state.n === 2) {
                // Bigram uses last 1 word
                context = state.history.length > 0 ? state.history[state.history.length - 1] : "";
            } else if (state.n === 3) {
                // Trigram uses last 2 words
                if (state.history.length >= 2) {
                    context = state.history.slice(-2).join(" ");
                } else if (state.history.length === 1) {
                    context = state.history[state.history.length - 1];
                } else {
                    context = "";
                }
            }

            // Generate count map
            const grams = getNGrams(state.n, tokens);

            let relevantCounts = {};

            if (state.history.length === 0) {
                // Just show frequency of all words (Unigram)
                const unigrams = getNGrams(1, tokens);
                relevantCounts = unigrams[""] || {};
            } else {
                let lookupKey = "";
                if (state.n === 1) lookupKey = "";
                else if (state.n === 2) lookupKey = state.history[state.history.length - 1];
                else if (state.n === 3) {
                    if (state.history.length >= 2) lookupKey = state.history.slice(-2).join(" ");
                    else lookupKey = state.history[state.history.length - 1];
                }

                relevantCounts = grams[lookupKey] || {};
            }

            // Convert counts to Array [ {word, count, prob} ]
            let total = 0;
            Object.values(relevantCounts).forEach(c => total += c);

            let results = Object.keys(relevantCounts).map(word => {
                return {
                    word: word,
                    count: relevantCounts[word],
                    prob: relevantCounts[word] / total
                };
            });

            // Sort by probability desc
            results.sort((a, b) => b.prob - a.prob);
            return { results, contextLabel: state.history.length === 0 ? "[Start]" : context };
        }

        // --- 3. RENDERING & INTERACTION ---

        const sentenceContainer = document.getElementById('sentence-container');
        const chartContainer = document.getElementById('chart-container');
        const contextMonitor = document.getElementById('context-monitor');
        const slider = document.getElementById('ngram-slider');
        const sliderDesc = document.getElementById('slider-desc');

        function updateSliderUI() {
            // Update labels highlight
            document.getElementById('label-1').className = state.n == 1 ? "chip-btn active px-2 py-1 rounded-lg cursor-pointer transition" : "chip-btn px-2 py-1 rounded-lg cursor-pointer transition";
            document.getElementById('label-2').className = state.n == 2 ? "chip-btn active px-2 py-1 rounded-lg cursor-pointer transition" : "chip-btn px-2 py-1 rounded-lg cursor-pointer transition";
            document.getElementById('label-3').className = state.n == 3 ? "chip-btn active px-2 py-1 rounded-lg cursor-pointer transition" : "chip-btn px-2 py-1 rounded-lg cursor-pointer transition";

            // Update Description
            const descs = [
                "Just picks words based on frequency. <strong>No context</strong>. Total chaos.",
                "Looks at the <strong>previous word</strong>. Makes local sense, but no long-term memory.",
                "Looks at the <strong>previous 2 words</strong>. Starts to form actual phrases from the story."
            ];
            sliderDesc.innerHTML = descs[state.n - 1];
        }

        function renderSentence() {
            sentenceContainer.innerHTML = '';
            state.history.forEach(word => {
                const span = document.createElement('span');
                span.textContent = word;
                span.className = "word-token px-3 py-1.5 rounded-lg text-brand-900 dark:text-white";
                sentenceContainer.appendChild(span);
            });

            // Update progress bar
            const progressBar = document.getElementById('progress-bar');
            const progress = Math.min((state.history.length / 10) * 100, 100);
            progressBar.style.width = progress + '%';
        }

        function renderChart() {
            const data = calculateNextWordProbs();

            // Update Context Label
            let contextText = data.contextLabel;
            if (state.n === 1) contextText = "None (Unigram)";
            else if (contextText === "") contextText = "Unknown Pattern";
            contextMonitor.textContent = `Context: "${contextText}"`;

            // Clear Chart
            chartContainer.innerHTML = '';

            if (data.results.length === 0) {
                chartContainer.innerHTML = `
                    <div class="w-full h-full flex flex-col items-center justify-center text-neutral-400 dark:text-white/40 text-center p-4">
                        <i data-lucide="ghost" class="w-10 h-10 mb-3 opacity-50"></i>
                        <p class="text-sm">No continuation found in data.</p>
                        <p class="text-xs mt-1">Try Reset or lowering N-Gram.</p>
                    </div>
                `;
                lucide.createIcons();
                return;
            }

            // Create Bars
            data.results.forEach((item, index) => {
                // Container for bar + label
                const wrapper = document.createElement('div');
                wrapper.className = "bar-container flex flex-col items-center justify-end h-full gap-2 min-w-[70px] cursor-pointer group";
                wrapper.onclick = () => addWord(item.word);

                // Percentage Label
                const percent = document.createElement('span');
                percent.className = "text-xs text-neutral-500 dark:text-white/50 font-mono opacity-0 group-hover:opacity-100 transition-opacity";
                percent.innerText = Math.round(item.prob * 100) + "%";

                // The Bar
                const bar = document.createElement('div');
                const height = Math.max(item.prob * 100, 10);

                // Dynamic Class based on probability
                let colorClass = "low";
                if (item.prob > 0.5) colorClass = "high";
                else if (item.prob > 0.2) colorClass = "medium";

                bar.className = `probability-bar ${colorClass} w-14 rounded-t-lg transition-all duration-500 ease-out`;
                bar.style.height = "0%";

                // Word Label
                const label = document.createElement('span');
                label.className = "text-xs font-bold text-neutral-600 dark:text-white/70 uppercase tracking-wider group-hover:text-brand-500 dark:group-hover:text-brandlt-400 transition-colors";
                label.innerText = item.word;

                wrapper.appendChild(percent);
                wrapper.appendChild(bar);
                wrapper.appendChild(label);
                chartContainer.appendChild(wrapper);

                // Animate Height with GSAP
                gsap.to(bar, {
                    height: `${height}%`,
                    duration: 0.5,
                    delay: index * 0.05,
                    ease: "back.out(1.7)"
                });
            });
        }

        // Action: Add Word
        function addWord(word) {
            state.history.push(word);
            renderSentence();
            renderChart();
        }

        function resetSimulation() {
            state.history = [];
            renderSentence();
            renderChart();
        }

        // Click handlers for the N-gram label chips
        document.getElementById('label-1').addEventListener('click', () => {
            state.n = 1;
            slider.value = 1;
            updateSliderUI();
            renderChart();
        });
        document.getElementById('label-2').addEventListener('click', () => {
            state.n = 2;
            slider.value = 2;
            updateSliderUI();
            renderChart();
        });
        document.getElementById('label-3').addEventListener('click', () => {
            state.n = 3;
            slider.value = 3;
            updateSliderUI();
            renderChart();
        });

        // --- 4. EVENT LISTENERS & INIT ---

        slider.addEventListener('input', (e) => {
            state.n = parseInt(e.target.value);
            updateSliderUI();
            renderChart();
        });

        // Initial Render
        resetSimulation();
        updateSliderUI();

        // Re-render MathJax after DOM is ready
        window.addEventListener('load', () => {
            if (typeof MathJax !== 'undefined') {
                MathJax.typeset();
            }
        });
    </script>
</body>

</html>