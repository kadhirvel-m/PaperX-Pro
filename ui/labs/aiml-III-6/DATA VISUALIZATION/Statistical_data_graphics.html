<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizing The Invisible: Data Graphics</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <script src="https://unpkg.com/lucide@latest"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617;
            /* Slate 950 */
            color: #e2e8f0;
            /* Slate 200 */
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        /* Glassmorphism Utilities */
        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .glass-control {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .glass-control:hover {
            background: rgba(51, 65, 85, 0.8);
            border-color: rgba(99, 102, 241, 0.5);
            /* Indigo 500 */
        }

        .active-mode {
            background: rgba(99, 102, 241, 0.2);
            border-color: #6366f1;
            color: #ffffff;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #020617;
        }

        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }
    </style>
</head>

<body class="min-h-screen overflow-x-hidden selection:bg-indigo-500 selection:text-white">

    <section class="min-h-screen flex flex-col justify-center items-center relative px-6 py-20 max-w-5xl mx-auto">
        <div class="absolute top-0 left-0 w-full h-full overflow-hidden -z-10 opacity-20 pointer-events-none">
            <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-indigo-600 rounded-full blur-[128px]"></div>
            <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-emerald-600 rounded-full blur-[128px]"></div>
        </div>

        <div class="text-center space-y-8 animate-fade-in">
            <div
                class="inline-flex items-center justify-center p-6 bg-slate-900/50 rounded-full border border-slate-800 mb-4">
                <i data-lucide="library" class="w-16 h-16 text-indigo-400"></i>
            </div>

            <h1
                class="text-5xl md:text-7xl font-extrabold tracking-tight bg-gradient-to-br from-white to-slate-400 bg-clip-text text-transparent">
                The Library of Babel
            </h1>

            <p class="text-xl md:text-2xl text-slate-400 max-w-2xl mx-auto leading-relaxed">
                Imagine a library where 10,000 books are dumped in a chaotic pile on the floor. <br>
                <span class="text-white font-semibold">That pile is Raw Data.</span>
            </p>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left max-w-4xl mt-12">
                <div
                    class="p-6 rounded-2xl border border-slate-800 bg-slate-900/40 hover:border-indigo-500/50 transition-colors">
                    <div class="flex items-center gap-3 mb-3 text-indigo-400">
                        <i data-lucide="bar-chart-2" class="w-6 h-6"></i>
                        <span class="font-bold">Sorting by Genre</span>
                    </div>
                    <p class="text-slate-400 text-sm">Grouping similar items into stacks creates a
                        <strong>Histogram</strong> (Distribution).</p>
                </div>

                <div
                    class="p-6 rounded-2xl border border-slate-800 bg-slate-900/40 hover:border-emerald-500/50 transition-colors">
                    <div class="flex items-center gap-3 mb-3 text-emerald-400">
                        <i data-lucide="scatter-chart" class="w-6 h-6"></i>
                        <span class="font-bold">Mapping by Year</span>
                    </div>
                    <p class="text-slate-400 text-sm">Placing items on a timeline reveals trends. This is a
                        <strong>Scatter Plot</strong> (Correlation).</p>
                </div>

                <div
                    class="p-6 rounded-2xl border border-slate-800 bg-slate-900/40 hover:border-amber-500/50 transition-colors">
                    <div class="flex items-center gap-3 mb-3 text-amber-400">
                        <i data-lucide="box-select" class="w-6 h-6"></i>
                        <span class="font-bold">Summarizing</span>
                    </div>
                    <p class="text-slate-400 text-sm">Packing the "average" books into a box creates a <strong>Box
                            Plot</strong> (Summary).</p>
                </div>
            </div>

            <div class="pt-12">
                <p class="text-sm font-mono text-indigo-400 animate-bounce">SCROLL TO ORGANIZE THE CHAOS &darr;</p>
            </div>
        </div>
    </section>

    <section class="py-12 px-4 md:px-8 max-w-7xl mx-auto">
        <div class="flex flex-col lg:flex-row gap-6 h-[800px] lg:h-[600px]">

            <div class="w-full lg:w-1/4 flex flex-col gap-4">
                <div class="glass-panel rounded-2xl p-6 h-full flex flex-col">
                    <h3 class="text-lg font-bold text-white mb-1">The Data Shaper</h3>
                    <p class="text-xs text-slate-400 mb-6">Manipulate the forces acting on the data points.</p>

                    <div class="space-y-3 mb-8">
                        <label class="text-xs font-mono text-slate-500 uppercase tracking-wider">Visualization
                            Mode</label>
                        <button onclick="setMode('chaos')" id="btn-chaos"
                            class="glass-control w-full p-3 rounded-lg flex items-center gap-3 text-sm font-medium text-slate-300 active-mode">
                            <i data-lucide="sparkles" class="w-4 h-4"></i> Chaos (Raw)
                        </button>
                        <button onclick="setMode('histogram')" id="btn-histogram"
                            class="glass-control w-full p-3 rounded-lg flex items-center gap-3 text-sm font-medium text-slate-300">
                            <i data-lucide="bar-chart-big" class="w-4 h-4"></i> Histogram
                        </button>
                        <button onclick="setMode('scatter')" id="btn-scatter"
                            class="glass-control w-full p-3 rounded-lg flex items-center gap-3 text-sm font-medium text-slate-300">
                            <i data-lucide="scatter-chart" class="w-4 h-4"></i> Scatter Plot
                        </button>
                        <button onclick="setMode('box')" id="btn-box"
                            class="glass-control w-full p-3 rounded-lg flex items-center gap-3 text-sm font-medium text-slate-300">
                            <i data-lucide="box" class="w-4 h-4"></i> Box Plot (1D)
                        </button>
                    </div>

                    <div class="space-y-6 mt-auto">
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-xs font-mono text-slate-500 uppercase">Data Bias (Skew)</label>
                                <span id="skew-val" class="text-xs font-mono text-indigo-400">0.0</span>
                            </div>
                            <input type="range" id="skew-slider" min="-2" max="2" step="0.1" value="0"
                                class="w-full h-1 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-indigo-500 hover:accent-indigo-400">
                        </div>

                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-xs font-mono text-slate-500 uppercase">Sample Size</label>
                                <span id="count-val" class="text-xs font-mono text-emerald-400">400</span>
                            </div>
                            <input type="range" id="count-slider" min="50" max="800" step="50" value="400"
                                class="w-full h-1 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500 hover:accent-emerald-400">
                        </div>
                    </div>
                </div>
            </div>

            <div class="w-full lg:w-3/4 relative glass-panel rounded-2xl overflow-hidden border border-slate-800">
                <canvas id="simCanvas" class="w-full h-full block"></canvas>

                <div id="overlay-text"
                    class="absolute top-6 left-6 pointer-events-none transition-opacity duration-300 opacity-0">
                    <h2 class="text-2xl font-bold text-white mb-2" id="overlay-title">Mode</h2>
                    <p class="text-sm text-slate-300 max-w-md bg-slate-950/80 p-3 rounded-lg backdrop-blur-sm"
                        id="overlay-desc">Description</p>
                </div>
            </div>
        </div>
    </section>

    <section class="py-20 px-6 max-w-7xl mx-auto">
        <div class="mb-12">
            <h2 class="text-3xl font-bold text-white mb-4">Under The Hood</h2>
            <div class="h-1 w-20 bg-indigo-500 rounded"></div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <div class="glass-panel p-6 rounded-2xl border-t-4 border-t-indigo-500 flex flex-col">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-white">Distribution</h3>
                    <i data-lucide="bar-chart-2" class="text-indigo-400 w-5 h-5"></i>
                </div>
                <p class="text-sm text-slate-400 mb-4 flex-grow">
                    Used to see the frequency of values. We "bin" continuous data into discrete buckets.
                </p>
                <div class="bg-slate-900/50 p-3 rounded border border-slate-800 font-mono text-xs text-indigo-300">
                    bins = Math.floor(value / binWidth)
                </div>
            </div>

            <div class="glass-panel p-6 rounded-2xl border-t-4 border-t-emerald-500 flex flex-col">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-white">Correlation</h3>
                    <i data-lucide="activity" class="text-emerald-400 w-5 h-5"></i>
                </div>
                <p class="text-sm text-slate-400 mb-4 flex-grow">
                    Reveals relationships between two variables ($X$ and $Y$). Look for linear trends or clusters.
                </p>
                <div class="bg-slate-900/50 p-3 rounded border border-slate-800 font-mono text-xs text-emerald-300">
                    y = mx + b + noise
                </div>
            </div>

            <div class="glass-panel p-6 rounded-2xl border-t-4 border-t-amber-500 flex flex-col">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-white">Summary</h3>
                    <i data-lucide="sigma" class="text-amber-400 w-5 h-5"></i>
                </div>
                <p class="text-sm text-slate-400 mb-4 flex-grow">
                    Box plots strip away the noise to show the Median (50th percentile) and IQR (25th-75th).
                </p>
                <div class="bg-slate-900/50 p-3 rounded border border-slate-800 font-mono text-xs text-amber-300">
                    IQR = Q3 - Q1
                </div>
            </div>

            <div class="glass-panel p-6 rounded-2xl border-t-4 border-t-pink-500 flex flex-col">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-white">The Point</h3>
                    <i data-lucide="circle-dot" class="text-pink-400 w-5 h-5"></i>
                </div>
                <p class="text-sm text-slate-400 mb-4 flex-grow">
                    Remember: Every bar, line, or box is made of individual observations. Never lose the context.
                </p>
                <div class="bg-slate-900/50 p-3 rounded border border-slate-800 font-mono text-xs text-pink-300">
                    { id: 402, val: 0.85 }
                </div>
            </div>
        </div>
    </section>

    <footer class="text-center py-8 border-t border-slate-800 text-slate-500 text-sm">
        <p>Designed for Interactive Learning.</p>
    </footer>

    <script>
        // --- 1. CONFIGURATION & STATE ---
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;

        // Simulation State
        const state = {
            mode: 'chaos', // chaos, histogram, scatter, box
            particles: [],
            count: 400,
            skew: 0,
            colors: ['#6366f1', '#10b981', '#f59e0b', '#ec4899'] // Indigo, Emerald, Amber, Pink
        };

        // UI References
        const skewSlider = document.getElementById('skew-slider');
        const countSlider = document.getElementById('count-slider');
        const skewVal = document.getElementById('skew-val');
        const countVal = document.getElementById('count-val');
        const overlay = document.getElementById('overlay-text');
        const overlayTitle = document.getElementById('overlay-title');
        const overlayDesc = document.getElementById('overlay-desc');

        // --- 2. PARTICLE SYSTEM ---
        class Particle {
            constructor(id) {
                this.id = id;
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.size = 3;
                this.color = state.colors[Math.floor(Math.random() * state.colors.length)];

                // Data Properties (Normalized 0-1)
                this.valX = Math.random();
                this.valY = Math.random();

                // Physics Target
                this.targetX = this.x;
                this.targetY = this.y;
            }

            updateData(skew) {
                // Generate data based on skew (Box-Muller transform approximation or power)
                let u = 0, v = 0;
                while (u === 0) u = Math.random();
                while (v === 0) v = Math.random();
                // Standard Normal Distribution
                let num = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
                num = num / 10.0 + 0.5; // Shift to 0.5 center

                if (num > 1 || num < 0) num = Math.random(); // Clamp outliers lightly

                // Apply Skew: Power function shifts distribution
                if (skew !== 0) {
                    const power = skew > 0 ? 1 + skew : 1 / (1 + Math.abs(skew));
                    this.valX = Math.pow(Math.random(), power);
                } else {
                    // Slight Gaussian bias for natural feel
                    this.valX = (Math.random() + Math.random() + Math.random()) / 3;
                }

                // Correlated Y for scatter plots
                this.valY = this.valX + (Math.random() - 0.5) * 0.5;
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
            }
        }

        // --- 3. LAYOUT LOGIC ---
        function calculateTargets() {
            const padding = 60;
            const effectiveW = width - padding * 2;
            const effectiveH = height - padding * 2;

            // Sort particles by valX for organized stacking
            const sortedIndices = state.particles.map((p, i) => ({ val: p.valX, idx: i }))
                .sort((a, b) => a.val - b.val);

            // 1. CHAOS MODE
            if (state.mode === 'chaos') {
                state.particles.forEach(p => {
                    // Only assign new random targets occasionally or keep floating?
                    // Let's just spread them randomly but smoothly
                    if (Math.random() > 0.95) {
                        // gentle float handled in loop, here we reset to random bounds
                        p.targetX = Math.random() * width;
                        p.targetY = Math.random() * height;
                    }
                });
            }

            // 2. HISTOGRAM MODE
            else if (state.mode === 'histogram') {
                const bins = 20;
                const binWidth = effectiveW / bins;
                const binCounts = new Array(bins).fill(0);

                state.particles.forEach(p => {
                    const binIndex = Math.floor(p.valX * bins);
                    const safeBin = Math.min(Math.max(binIndex, 0), bins - 1);

                    p.targetX = padding + (safeBin * binWidth) + (Math.random() * (binWidth - 4));
                    // Stack upwards
                    p.targetY = (height - padding) - (binCounts[safeBin] * (p.size * 2.5));

                    binCounts[safeBin]++;
                });
            }

            // 3. SCATTER PLOT MODE
            else if (state.mode === 'scatter') {
                state.particles.forEach(p => {
                    p.targetX = padding + (p.valX * effectiveW);
                    // Invert Y because canvas Y=0 is top
                    p.targetY = (height - padding) - (p.valY * effectiveH * 0.8); // 0.8 to keep it visible
                });
            }

            // 4. BOX PLOT MODE (Simplified 1D Strip Plot)
            else if (state.mode === 'box') {
                // Calculate Quartiles
                const values = state.particles.map(p => p.valX).sort((a, b) => a - b);
                const q1 = values[Math.floor(values.length * 0.25)];
                const median = values[Math.floor(values.length * 0.5)];
                const q3 = values[Math.floor(values.length * 0.75)];

                state.particles.forEach(p => {
                    // Horizontal Position determines value
                    p.targetX = padding + (p.valX * effectiveW);

                    // Vertical Position:
                    // If inside IQR, tight cluster. If outside, spread out (whiskers).
                    const centerY = height / 2;
                    if (p.valX >= q1 && p.valX <= q3) {
                        // Inside box
                        p.targetY = centerY + (Math.random() * 60 - 30);
                    } else {
                        // Whiskers
                        p.targetY = centerY;
                    }
                });
            }

            // Trigger GSAP Animations
            state.particles.forEach(p => {
                gsap.to(p, {
                    x: p.targetX,
                    y: p.targetY,
                    duration: 1.5,
                    ease: "power3.out"
                });
            });
        }

        // --- 4. INITIALIZATION & EVENTS ---

        function init() {
            resize();
            createParticles();
            lucide.createIcons();
            loop();
        }

        function createParticles() {
            state.particles = [];
            for (let i = 0; i < state.count; i++) {
                const p = new Particle(i);
                p.updateData(state.skew);
                state.particles.push(p);
            }
            calculateTargets();
        }

        function resize() {
            const rect = canvas.parentElement.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;
            width = canvas.width;
            height = canvas.height;
            if (state.particles.length > 0) calculateTargets();
        }

        function drawOverlay() {
            // Draw axis lines if not chaos
            if (state.mode !== 'chaos') {
                ctx.strokeStyle = '#334155';
                ctx.lineWidth = 2;
                const p = 60;

                // X Axis
                ctx.beginPath();
                ctx.moveTo(p, height - p + 10);
                ctx.lineTo(width - p, height - p + 10);
                ctx.stroke();

                // Y Axis (only for Scatter/Histogram)
                if (state.mode !== 'box') {
                    ctx.beginPath();
                    ctx.moveTo(p - 10, p);
                    ctx.lineTo(p - 10, height - p);
                    ctx.stroke();
                }

                // Draw Box Plot Overlay
                if (state.mode === 'box') {
                    const values = state.particles.map(p => p.valX).sort((a, b) => a - b);
                    const q1 = values[Math.floor(values.length * 0.25)];
                    const q3 = values[Math.floor(values.length * 0.75)];
                    const median = values[Math.floor(values.length * 0.5)];

                    const effectiveW = width - 120;
                    const startX = 60;

                    const xQ1 = startX + (q1 * effectiveW);
                    const xQ3 = startX + (q3 * effectiveW);
                    const xMed = startX + (median * effectiveW);
                    const yTop = height / 2 - 50;
                    const yBot = height / 2 + 50;

                    ctx.strokeStyle = '#f59e0b'; // Amber
                    ctx.lineWidth = 3;

                    // Box
                    ctx.strokeRect(xQ1, yTop, xQ3 - xQ1, 100);

                    // Median Line
                    ctx.beginPath();
                    ctx.moveTo(xMed, yTop);
                    ctx.lineTo(xMed, yBot);
                    ctx.stroke();
                }
            }
        }

        function loop() {
            ctx.clearRect(0, 0, width, height);

            drawOverlay();

            state.particles.forEach(p => {
                p.draw();
            });

            requestAnimationFrame(loop);
        }

        // --- 5. INTERACTION HANDLERS ---

        window.setMode = (mode) => {
            state.mode = mode;

            // UI Updates
            document.querySelectorAll('.glass-control').forEach(btn => btn.classList.remove('active-mode'));
            document.getElementById(`btn-${mode}`).classList.add('active-mode');

            // Text Updates
            overlay.style.opacity = 1;
            const texts = {
                'chaos': { title: 'Raw Data', desc: 'Unsorted, unstructured. Impossible to find patterns visually.' },
                'histogram': { title: 'Histogram', desc: 'Grouping data into bins to visualize distribution density.' },
                'scatter': { title: 'Scatter Plot', desc: 'Mapping two variables against each other to find correlations.' },
                'box': { title: 'Box Plot', desc: 'Visualizing statistical quartiles: The Box is the middle 50%.' }
            };
            overlayTitle.innerText = texts[mode].title;
            overlayDesc.innerText = texts[mode].desc;

            calculateTargets();
        };

        // Slider Listeners
        skewSlider.addEventListener('input', (e) => {
            state.skew = parseFloat(e.target.value);
            skewVal.innerText = state.skew.toFixed(1);
            // Re-generate data values
            state.particles.forEach(p => p.updateData(state.skew));
            calculateTargets();
        });

        countSlider.addEventListener('input', (e) => {
            const newCount = parseInt(e.target.value);
            state.count = newCount;
            countVal.innerText = newCount;
            createParticles(); // Rebuild system
        });

        window.addEventListener('resize', resize);

        // Start
        init();

    </script>
</body>

</html>